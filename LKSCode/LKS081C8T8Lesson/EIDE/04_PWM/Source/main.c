#include "lks32mc08x_lib.h"

/*
 * 实验名称：双通道交替呼吸灯 (LKS32MC081C8T8)
 *---------------------------------------------------------------------------
 * 目的：
 *   1. 学习 GPIO 复用为 UTimer 比较输出的方法；
 *   2. 掌握 UTimer 在比较模式下通过动态修改 CMPT 寄存器实现 PWM 占空比调制；
 *   3. 通过在 ZERO 中断内调整占空比，实现两路 LED 交替"呼吸"效果；
 *   4. 练习 NVIC、系统时钟及外围初始化流程。
 *---------------------------------------------------------------------------
 * 理论公式：
 *   ? 计数时钟   f_cnt = f_src / 2^CLKDIV           (CLKDIV 取 TIM_Clk_Divx 常数)
 *   ? PWM 频率   f_PWM = f_cnt / (TH + 1)
 *   ? 占空比     D     = CMPT / (TH + 1)
 *   其中：TH 为定时器计数门限，CMPT 为比较寄存器当前值。
 *---------------------------------------------------------------------------
 * 本例参数：
 *   f_src  = 96 MHz (PLL)   ，CLKDIV = 8  → f_cnt = 12 MHz
 *   TH     = 29 999         → f_PWM ≈ 400 Hz
 *   CMPT   在  2 400 (≈8 %) … 30 000 范围往返变化，实现亮度渐变。
 *---------------------------------------------------------------------------
 * 实现步骤摘要：
 *   Step-1 时钟：SystemInit() 内调用 Clock_Init() 把主频锁到 96 MHz。
 *   Step-2 GPIO ：GPIO_init() 将 P0.6 / P0.7 设置为 AF 并复用到 TIM1_CH0/1。
 *   Step-3 Timer：Timer_init() 把 UTIMER1 配置成 400 Hz PWM，初始占空 0 %。
 *   Step-4 NVIC ：Hardware_init() 为 UTIMER1_ZERO 中断设优先级并使能。
 *   Step-5 ISR  ：UTIMER1_IRQHandler() 在每个 ZERO 中断里按三角波算法修改
 *                 CMPT0/1，使两颗 LED 以 8 %~92 % 占空来回变化且相位互补。
 *---------------------------------------------------------------------------
 * PWM 概念简介：
 *   Pulse-Width Modulation（脉宽调制）是一种用固定频率的矩形波，通过调节
 *   "高电平持续时间 / 周期"――即占空比――来间接输出任意平均电压/功率的
 *   技术。在 MCU 上常用定时器比较单元硬件生成：
 *     ① 定时器计数 0→TH；
 *     ② CNT=0 时先输出预设电平；
 *     ③ CNT=CMPT 时自动翻转；
 *     ④ CNT>TH 回零重来，形成周期方波。
 *   更改 CMPT 即等价于调占空比。
 *
 * 本实验如何使用 PWM：
 *   ? 载波定在 400 Hz（TH = 29 999, CLKDIV = /8），人眼与手机均无闪烁；
 *   ? 在 ZERO 中断里把 CMPT 做三角波递增递减，使 LED 亮度 ≈8 %?92 % 平
 *     滑往返，即"呼吸"；
 *   ? 两路比较值互补 (CMPT0=x, CMPT1=TH-x+MIN)，实现两颗 LED 交替呼吸。
 *---------------------------------------------------------------------------
 */

int main(void)
{
    Hardware_init(); /* 硬件初始化*/

    while (1)
    {
    }
}

/************************ (C) COPYRIGHT LINKO SEMICONDUCTOR
 * **********************/
/* ------------------------------END OF FILE------------------------------------
 */
